<script setup lang="ts">
interface Menu {
  path: string
  label: string
}

const { t, tm, rt, locale } = useI18n()
const switchLocalePath = useSwitchLocalePath()
const { menuOpen, closeMenu, toggleMenu } = useMenu()
const { theme, toggleTheme } = useTheme()
const { langNext, isLangNext, langTooltip } = useTooltip()
</script>

<template>
  <header>
    <NuxtLink to="#main" class="skip">
      {{ t('skip') }}
    </NuxtLink>

    <NuxtLinkLocale to="/" class="logo" :aria-label="t('name')">
      <svg
        v-if="locale === 'ar'"
        xmlns="http://www.w3.org/2000/svg"
        width="153"
        height="24"
        viewBox="0 0 153 24"
        role="img"
        aria-hidden="true"
      >
        <path fill="#50c8f0" d="M146.957 0a5.333 5.333 0 1 1 0 10.667 5.333 5.333 0 0 1 0-10.667Zm0 13.333a5.333 5.333 0 1 1 0 10.667 5.333 5.333 0 0 1 0-10.667Zm-13.333 0a5.333 5.333 0 1 1 0 10.667 5.333 5.333 0 0 1 0-10.667Z" />
        <path :fill="theme === 'theme-light' ? '#28285a' : '#fff'" d="M109.929 18.058c-.077 0-.116-.039-.116-.116v-2.646c0-.062.039-.093.116-.093h4.155V6.29h3.54v11.768h-7.695ZM111.844 24c-.487 0-.874-.155-1.16-.464-.287-.302-.43-.716-.43-1.242 0-.534.139-.956.418-1.265.286-.302.677-.453 1.172-.453.488 0 .871.151 1.149.453.279.302.418.723.418 1.265 0 .542-.143.96-.43 1.253-.286.302-.665.453-1.137.453Zm4.039 0c-.488 0-.874-.155-1.161-.464-.286-.302-.429-.716-.429-1.242 0-.534.139-.956.418-1.265.286-.302.677-.453 1.172-.453.495 0 .882.151 1.16.453.279.31.418.731.418 1.265 0 .526-.147.94-.441 1.242-.286.31-.665.464-1.137.464Zm-4.771-8.797c.077 0 .116.031.116.093v2.646c0 .077-.039.116-.116.116h-2.971c0 1.81-.549 3.215-1.648 4.213-1.091.998-2.634 1.497-4.63 1.497-1.076 0-2.008-.085-2.797-.255a7.313 7.313 0 0 1-2.263-.894l1.38-2.588a7.534 7.534 0 0 0 3.61.905c.897 0 1.59-.247 2.077-.743.488-.487.731-1.16.731-2.019v-.116h-2.355c-1.695 0-2.998-.48-3.911-1.439-.913-.96-1.37-2.325-1.37-4.097 0-1.253.313-2.352.94-3.296.627-.951 1.513-1.679 2.658-2.182 1.145-.502 2.468-.754 3.969-.754h3.609v8.913h2.971Zm-6.511 0V9.145h-.766c-1.013 0-1.806.286-2.379.859-.564.572-.847 1.38-.847 2.425 0 .952.194 1.652.58 2.101.387.449.979.673 1.776.673h1.636Zm-16.933 2.855c-.077 0-.116-.039-.116-.116v-2.646c0-.062.039-.093.116-.093h2.971V6.29h3.54v11.768h-6.51Zm4.712-13.81c-.495 0-.886-.151-1.172-.453-.286-.31-.43-.727-.43-1.253 0-.534.14-.952.418-1.254.287-.31.681-.464 1.184-.464.48 0 .859.15 1.137.453.287.301.43.723.43 1.265 0 .526-.147.943-.441 1.253-.287.302-.662.453-1.126.453Zm-14.322 13.81c-.077 0-.116-.039-.116-.116v-2.646c0-.062.039-.093.116-.093h3.679V6.29h3.54v8.913h3.574c.077 0 .116.031.116.093v2.646c0 .077-.039.116-.116.116H78.058ZM81.238 24c-.487 0-.874-.155-1.16-.464-.287-.302-.43-.716-.43-1.242 0-.534.14-.956.418-1.265.286-.302.677-.453 1.172-.453.487 0 .87.151 1.149.453.278.302.418.723.418 1.265 0 .542-.144.96-.43 1.253-.286.302-.665.453-1.137.453Zm4.039 0c-.488 0-.875-.155-1.161-.464-.286-.302-.43-.716-.43-1.242 0-.534.14-.956.418-1.265.287-.302.677-.453 1.173-.453.495 0 .882.151 1.16.453.279.31.418.731.418 1.265 0 .526-.147.94-.441 1.242-.286.31-.665.464-1.137.464Zm-6.048-8.797c.078 0 .116.031.116.093v2.646c0 .077-.038.116-.116.116H62.831c-.078 0-.116-.039-.116-.116v-2.646c0-.062.038-.093.116-.093h3.4a4.708 4.708 0 0 1-1.149-3.133c0-1.772.611-3.176 1.834-4.213 1.222-1.045 2.924-1.567 5.106-1.567h4.236v8.913h2.971Zm-6.51 0V9.145h-.627c-1.068 0-1.896.267-2.484.8-.588.527-.882 1.297-.882 2.31 0 .944.283 1.671.847 2.182.573.51 1.397.766 2.473.766h.673Zm-.952-10.955c-.495 0-.886-.151-1.172-.453-.287-.31-.43-.727-.43-1.253 0-.534.14-.952.418-1.254.287-.31.681-.464 1.184-.464.48 0 .859.15 1.137.453.287.301.43.723.43 1.265 0 .526-.147.943-.441 1.253-.287.302-.662.453-1.126.453Zm-7.753 10.955c.077 0 .116.031.116.093v2.646c0 .077-.039.116-.116.116h-6.511V0h3.54v15.203h2.97Zm-14.937 8.565a8.176 8.176 0 0 1-2.24-.29c-.673-.194-1.385-.542-2.136-1.045l1.428-2.31c.418.264.785.446 1.102.546.325.1.712.151 1.16.151.635 0 1.146-.244 1.533-.731.387-.48.58-1.087.58-1.822V6.29h3.54v12.151c0 1.633-.453 2.928-1.358 3.888-.898.96-2.1 1.439-3.61 1.439Zm-10.771 0c-1.076 0-2.008-.085-2.797-.255a7.313 7.313 0 0 1-2.263-.894l1.38-2.588a7.539 7.539 0 0 0 3.61.905c.898 0 1.59-.247 2.078-.743.487-.487.73-1.16.73-2.019v-.116H38.69c-1.695 0-2.998-.48-3.911-1.439-.913-.96-1.37-2.325-1.37-4.097 0-1.253.314-2.352.94-3.296.627-.951 1.513-1.679 2.658-2.182 1.145-.502 2.468-.754 3.969-.754h3.61v11.838c0 1.802-.55 3.191-1.649 4.166-1.09.983-2.634 1.474-4.63 1.474Zm2.739-8.565V9.145h-.766c-1.014 0-1.807.286-2.38.859-.564.572-.847 1.38-.847 2.425 0 .952.194 1.652.58 2.101.388.449.98.673 1.776.673h1.637ZM26.723 0h3.54v18.058h-3.54V0ZM10.962 18.058c-1.463 0-2.62-.425-3.47-1.277-.844-.85-1.265-2.019-1.265-3.504 0-.596.07-1.23.208-1.904.14-.68.325-1.257.557-1.729h3.134a13.656 13.656 0 0 0-.36 3.11c0 .735.205 1.327.615 1.776.41.449.952.673 1.625.673h7.718V6.29h3.55v11.768H10.962ZM15.266 24c-.495 0-.886-.155-1.172-.464-.286-.302-.43-.716-.43-1.242 0-.534.14-.956.418-1.265.287-.302.681-.453 1.184-.453.48 0 .859.151 1.137.453.287.302.43.723.43 1.265 0 .526-.147.94-.441 1.242-.286.31-.662.464-1.126.464ZM.211 16.394c0-.729.198-1.236.594-1.52.396-.302.88-.453 1.45-.453.555 0 1.03.151 1.426.452.396.285.594.792.594 1.521 0 .698-.198 1.205-.594 1.521-.396.302-.871.452-1.426.452-.57 0-1.054-.15-1.45-.452-.396-.316-.594-.823-.594-1.52Z" />
      </svg>
      <svg
        v-else
        xmlns="http://www.w3.org/2000/svg"
        width="195"
        height="24"
        viewBox="0 0 195 24"
        role="img"
        aria-hidden="true"
      >
        <path fill="#50C8F0" d="M24 18.667a5.333 5.333 0 1 1-10.667 0 5.333 5.333 0 0 1 10.667 0ZM10.667 18.667a5.333 5.333 0 1 1-10.667 0 5.333 5.333 0 0 1 10.667 0ZM10.667 5.333A5.333 5.333 0 1 1 0 5.333a5.333 5.333 0 0 1 10.667 0Z" />
        <path :fill="theme === 'theme-light' ? '#28285a' : '#fff'" d="M49.77 23.367h-3.388v-2.058C45.274 22.987 43.247 24 41.189 24c-3.958 0-6.522-2.913-6.522-6.902V7.282h3.45v9.562c0 2.375 1.394 4.085 3.832 4.085 2.375 0 4.401-1.837 4.401-4.401V7.282h3.42v16.085ZM53.073 7.282h3.388V9.34c1.14-1.678 3.134-2.69 5.224-2.69 3.926 0 6.49 2.912 6.49 6.902v9.815h-3.419v-9.562c0-2.375-1.425-4.085-3.83-4.085-2.407 0-4.402 1.837-4.402 4.401v9.246h-3.451V7.282ZM71.606 7.282h3.42v16.085h-3.42V7.282Zm1.71-2.596c-1.267 0-2.154-.887-2.154-2.121 0-1.204.887-2.058 2.153-2.058 1.235 0 2.122.854 2.122 2.058 0 1.234-.887 2.121-2.122 2.121ZM88.048 23.367h-4.845L77.314 7.282h3.673l4.623 13.425 4.654-13.425h3.705l-5.921 16.085ZM97.853 13.836h10.005c-.38-2.533-2.406-4.306-5.066-4.306-2.596 0-4.496 1.742-4.939 4.306Zm-3.578 1.299c0-4.94 3.61-8.486 8.612-8.486 5.003 0 8.549 3.546 8.549 8.517 0 .38-.031.855-.063 1.235l-13.552-.032c.412 2.85 2.407 4.75 5.035 4.75 2.153 0 4.148-1.267 4.749-3.04l3.23.475c-.919 3.166-4.243 5.446-7.916 5.446-5.034 0-8.644-3.704-8.644-8.865ZM113.96 7.282h3.324V9.34c.982-1.646 2.533-2.628 4.37-2.628.633 0 1.361.159 2.058.412v3.071a6.742 6.742 0 0 0-2.502-.506c-2.279 0-3.799 2.026-3.799 4.876v8.802h-3.451V7.282ZM134.23 23.367h-4.528L124.51 7.282h3.577l4.022 12.697 3.546-12.697h3.641l3.673 12.76 3.957-12.76h3.547l-5.256 16.085h-4.528l-3.198-12.095-3.261 12.095ZM155.43 13.836h10.006c-.38-2.533-2.407-4.306-5.066-4.306-2.597 0-4.496 1.742-4.94 4.306Zm-3.578 1.299c0-4.94 3.61-8.486 8.613-8.486 5.002 0 8.548 3.546 8.548 8.517 0 .38-.031.855-.063 1.235l-13.551-.032c.411 2.85 2.406 4.75 5.034 4.75 2.153 0 4.148-1.267 4.749-3.04l3.23.475c-.918 3.166-4.243 5.446-7.916 5.446-5.034 0-8.644-3.704-8.644-8.865ZM180.149 9.879c-3.071 0-5.288 2.311-5.288 5.446 0 3.134 2.217 5.445 5.288 5.445 3.039 0 5.319-2.248 5.319-5.445 0-3.135-2.248-5.446-5.319-5.446Zm8.739 5.446c0 5.034-3.42 8.675-8.074 8.675-2.47 0-4.528-1.076-5.921-2.881v2.248h-3.356V0h3.451v9.467c1.361-1.773 3.419-2.818 5.826-2.818 4.686 0 8.074 3.641 8.074 8.675ZM192.781 23.81c-1.235 0-2.121-.886-2.121-2.121 0-1.204.886-2.058 2.121-2.058 1.267 0 2.121.854 2.121 2.058 0 1.235-.854 2.121-2.121 2.121Z" />
      </svg>
    </NuxtLinkLocale>

    <nav class="nav" :style="{ '--item-total': tm('menu').length }">
      <ul class="menu">
        <li v-for="(item, index) in (tm('menu') as Menu[])" :key="index">
          <NuxtLinkLocale :to="rt(item.path)" active-class="active" :style="{ '--item-number': index }" @click.enter="closeMenu()">
            {{ rt(item.label) }}
          </NuxtLinkLocale>
        </li>
      </ul>
    </nav>

    <div class="switchers">
      <NuxtLink
        :to="switchLocalePath(langNext[0])"
        class="toggle-lang"
        :aria-label="t('ariaLabel.lang-switch')"
        role="switch"
        aria-checked="true"
        @click="langTooltip"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="currentColor"
          role="img"
          aria-hidden="true"
        >
          <path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7 1.62-4.33L19.12 17h-3.24z" />
        </svg>
        <span class="tooltip-lang" :class="{ active: isLangNext }">
          {{ langNext[1] }}
        </span>
      </NuxtLink>

      <button
        class="toggle-theme"
        type="button"
        role="switch"
        :aria-label="t(`ariaLabel.${theme}`)"
        aria-checked="true"
        @click="toggleTheme"
      >
        <Transition name="toggle-theme" mode="out-in">
          <svg
            v-if="theme === 'theme-light'"
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="currentColor"
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            role="img"
            aria-hidden="true"
          >
            <circle cx="12" cy="12" r="5" />
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" />
          </svg>
          <svg
            v-else
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="currentColor"
            role="img"
            aria-hidden="true"
          >
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
          </svg>
        </Transition>
      </button>

      <button
        class="toggle-menu"
        type="button"
        role="switch"
        :aria-label="t(`ariaLabel.menu-${menuOpen ? 'close' : 'open'}`)"
        aria-checked="true"
        @click="toggleMenu"
      >
        <span class="top" />
        <span class="middle" />
        <span class="bottom" />
      </button>
    </div>
  </header>
</template>
